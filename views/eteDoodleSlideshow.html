<!DOCTYPE html>
<html>
<head>
    <title>ETE Doodle Slideshow</title>

    <link rel="stylesheet" href="../public/css/slideshow.css"/>

    <script type="text/javascript" src="../public/js/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="../public/js/jquery.rs.slideshow.min.js"></script>

    <script type="text/javascript">

        var IMAGE_POLLING_INTERVAL_MS = 2 * 1000;

        var imageSlidesArray = [];
        var $slideshowDiv;

        var snapshotCountCallback = function (data) {
            console.log("Number of snapshots stored = " + data.snapshotCount);
        };

        var checkForNewImages = function () {
            console.log("Checking for new images...");

            $.ajax({dataType:'json',url:'http://localhost:3000/eteDoodle/snapshots/count', success:snapshotCountCallback})
                    .fail(function () { console.log("Failed to retrieve latest image index!")});

            setTimeout(checkForNewImages, IMAGE_POLLING_INTERVAL_MS);
        };

        $.support.cors = true;
        $(document).ready(function () {
            $slideshowDiv = $('#slideshow-div');

            $slideshowDiv.rsfSlideshow({
                interval: 3,
                transition: 500,
                effect: {
                    effects: Array('slideUp', 'slideLeft', 'slideRight'),
                    iteration: 'backAndForth'
                },
                slides: imageSlidesArray
            });

            setTimeout(checkForNewImages, IMAGE_POLLING_INTERVAL_MS);
        });
    </script>
</head>
<body>
<div id="slideshow-div" class="rs-slideshow">
    <div class="slide-container">
        <img src="images/ChariotLogo.jpg" alt="CHARIOT SOLUTIONS: Practical, Smart Software Development"
             title="CHARIOT SOLUTIONS: Practical, Smart Software Development"/>
    </div>

    <ol class="slides">
    </ol>
</div>
</body>
</html>